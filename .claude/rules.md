# VendHub Manager - –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –¥–ª—è Claude Code

## üéØ –ì–ª–∞–≤–Ω–∞—è —Ü–µ–ª—å

–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–µ–Ω–¥–∏–Ω–≥–æ–≤–æ–π —Å–µ—Ç—å—é **–ë–ï–ó –ø—Ä—è–º–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∞–ø–ø–∞—Ä–∞—Ç–∞–º–∏**, –∏—Å–ø–æ–ª—å–∑—É—è –ø–æ–¥—Ö–æ–¥ "–∫–æ–Ω—Ç—Ä–æ–ª—å —á–µ—Ä–µ–∑ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∞".

---

## üìã –û—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

### 1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

#### ‚úÖ –í–°–ï–ì–î–ê –ü–û–ú–ù–ò:
- **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∞–ø–ø–∞—Ä–∞—Ç–∞–º** - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤ –∏ –∏–º–ø–æ—Ä—Ç —Ñ–∞–π–ª–æ–≤
- **–§–æ—Ç–æ - –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã** - –∫–ª—é—á–µ–≤–æ–π –º–µ—Ö–∞–Ω–∏–∑–º –∫–æ–Ω—Ç—Ä–æ–ª—è
- **–ó–∞–¥–∞—á–∏ - —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º** - –≤—Å—ë –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ –∑–∞–¥–∞—á–∏
- **3 —É—Ä–æ–≤–Ω—è –æ—Å—Ç–∞—Ç–∫–æ–≤** - —Å–∫–ª–∞–¥—ã ‚Üí –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã ‚Üí –∞–ø–ø–∞—Ä–∞—Ç—ã
- **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ–∑–¥–µ** - –Ω–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å –∑–∞–¥–∞—á—É –±–µ–∑ —Ñ–æ—Ç–æ/–¥–∞–Ω–Ω—ã—Ö

#### ‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï:
- –ù–µ —Å–æ–∑–¥–∞–≤–∞–π —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∞–ø–ø–∞—Ä–∞—Ç–∞–º
- –ù–µ –¥–µ–ª–∞–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ (–æ–Ω–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Ä—É—á–Ω—É—é)
- –ù–µ –ø—Ä–æ–ø—É—Å–∫–∞–π –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –∑–∞–¥–∞—á
- –ù–µ –∏–≥–Ω–æ—Ä–∏—Ä—É–π –≤–∞–ª–∏–¥–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
- –ù–µ —Å–æ–∑–¥–∞–≤–∞–π —Å–ª–æ–∂–Ω—ã–µ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏ —Ç–∞–º, –≥–¥–µ –º–æ–∂–Ω–æ –ø—Ä–æ—â–µ

---

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
VendHub/
‚îú‚îÄ‚îÄ backend/                    # Backend (NestJS/FastAPI)
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modules/           # –ú–æ–¥—É–ª–∏ –ø–æ –¥–æ–º–µ–Ω–∞–º
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ machines/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tasks/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ nomenclature/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ inventory/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ common/            # –û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database/          # –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å–∏–¥—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config/            # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ test/                  # –¢–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ frontend/                   # Frontend (Next.js)
‚îÇ   ‚îú‚îÄ‚îÄ app/                   # App Router
‚îÇ   ‚îú‚îÄ‚îÄ components/            # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ lib/                   # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ telegram-bot/              # Telegram Bot
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ handlers/         # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ keyboards/        # Inline –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ package.json
‚îÇ
‚îú‚îÄ‚îÄ database/                  # –ú–∏–≥—Ä–∞—Ü–∏–∏ –∏ —Å—Ö–µ–º–∞
‚îÇ   ‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ seeds/
‚îÇ
‚îú‚îÄ‚îÄ docs/                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ architecture/
‚îÇ   ‚îú‚îÄ‚îÄ dictionaries/
‚îÇ   ‚îú‚îÄ‚îÄ guides/
‚îÇ   ‚îî‚îÄ‚îÄ api/
‚îÇ
‚îú‚îÄ‚îÄ .claude/                   # –ü—Ä–∞–≤–∏–ª–∞ Claude Code
‚îú‚îÄ‚îÄ docker-compose.yml
‚îî‚îÄ‚îÄ README.md
```

---

## üíª –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

### Backend (Node.js/TypeScript –∏–ª–∏ Python)

#### –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ:
```typescript
// –§–∞–π–ª—ã: kebab-case
user.service.ts
task.controller.ts
machine.entity.ts

// –ö–ª–∞—Å—Å—ã: PascalCase
class UserService {}
class TaskController {}

// –§—É–Ω–∫—Ü–∏–∏/–º–µ—Ç–æ–¥—ã: camelCase
async createTask() {}
async getUserById() {}

// –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã: UPPER_SNAKE_CASE
const MAX_FILE_SIZE = 5_000_000;
const DEFAULT_PAGE_SIZE = 20;

// Interfaces/Types: PascalCase —Å I prefix –¥–ª—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤
interface IUser {}
type TaskStatus = 'created' | 'in_progress' | 'completed';
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª—è:
```typescript
// users/
‚îú‚îÄ‚îÄ dto/
‚îÇ   ‚îú‚îÄ‚îÄ create-user.dto.ts
‚îÇ   ‚îú‚îÄ‚îÄ update-user.dto.ts
‚îÇ   ‚îî‚îÄ‚îÄ user-response.dto.ts
‚îú‚îÄ‚îÄ entities/
‚îÇ   ‚îî‚îÄ‚îÄ user.entity.ts
‚îú‚îÄ‚îÄ users.controller.ts
‚îú‚îÄ‚îÄ users.service.ts
‚îú‚îÄ‚îÄ users.module.ts
‚îî‚îÄ‚îÄ users.service.spec.ts
```

#### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏:
```typescript
/**
 * –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞–¥–∞—á—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
 *
 * –í–ê–ñ–ù–û: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–µ–∑–µ—Ä–≤–∏—Ä—É–µ—Ç —Ç–æ–≤–∞—Ä—ã –Ω–∞ —Å–∫–ª–∞–¥–µ
 *
 * @param createTaskDto - –î–∞–Ω–Ω—ã–µ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–¥–∞—á–∏
 * @param userId - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è-—Å–æ–∑–¥–∞—Ç–µ–ª—è
 * @returns –°–æ–∑–¥–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞
 * @throws BadRequestException –µ—Å–ª–∏ —Ç–æ–≤–∞—Ä—ã –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –Ω–∞ —Å–∫–ª–∞–¥–µ
 */
async createRefillTask(createTaskDto: CreateTaskDto, userId: string): Promise<Task> {
  // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
```

### Frontend (React/Next.js)

#### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
```typescript
// –§–∞–π–ª—ã: PascalCase.tsx
TaskList.tsx
MachineCard.tsx

// –•—É–∫–∏: camelCase, –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å use
useAuth.ts
useTasks.ts

// –£—Ç–∏–ª–∏—Ç—ã: camelCase
formatDate.ts
validatePhone.ts
```

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
```typescript
'use client';

import { useState } from 'react';
import { Task } from '@/types';

interface TaskCardProps {
  task: Task;
  onComplete: (taskId: string) => void;
}

/**
 * –ö–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–¥–∞—á–∏ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
 *
 * –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Å–ø–∏—Å–∫–µ –∑–∞–¥–∞—á –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞
 */
export function TaskCard({ task, onComplete }: TaskCardProps) {
  const [isLoading, setIsLoading] = useState(false);

  const handleComplete = async () => {
    setIsLoading(true);
    try {
      await onComplete(task.id);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <div className="task-card">
      {/* JSX */}
    </div>
  );
}
```

---

## üîí –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

### 1. –ó–∞–¥–∞—á–∏

```typescript
// ‚ùå –ü–õ–û–•–û - –º–æ–∂–Ω–æ –∑–∞–∫—Ä—ã—Ç—å –±–µ–∑ —Ñ–æ—Ç–æ
async completeTask(taskId: string) {
  await this.taskRepository.update(taskId, { status: 'completed' });
}

// ‚úÖ –•–û–†–û–®–û - –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
async completeTask(taskId: string) {
  const task = await this.taskRepository.findOne(taskId);

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ç–æ
  const photos = await this.fileRepository.find({
    entityType: 'task',
    entityId: taskId
  });

  const photosBefore = photos.filter(p => p.category === 'task_photo_before');
  const photosAfter = photos.filter(p => p.category === 'task_photo_after');

  if (photosBefore.length === 0) {
    throw new BadRequestException('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ñ–æ—Ç–æ –î–û –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è');
  }

  if (photosAfter.length === 0) {
    throw new BadRequestException('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ñ–æ—Ç–æ –ü–û–°–õ–ï –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è');
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∫–æ–ª–∏—á–µ—Å—Ç–≤ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è
  if (task.type === 'refill') {
    const items = await this.taskItemRepository.find({ taskId });
    const missingQuantities = items.filter(i => !i.actualQuantity);

    if (missingQuantities.length > 0) {
      throw new BadRequestException('–£–∫–∞–∂–∏—Ç–µ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤');
    }
  }

  // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É–º–º—ã –¥–ª—è –∏–Ω–∫–∞—Å—Å–∞—Ü–∏–∏
  if (task.type === 'collection' && !task.actualAmount) {
    throw new BadRequestException('–£–∫–∞–∂–∏—Ç–µ —Å–æ–±—Ä–∞–Ω–Ω—É—é —Å—É–º–º—É');
  }

  // –ó–∞–∫—Ä—ã—Ç–∏–µ –∑–∞–¥–∞—á–∏
  await this.taskRepository.update(taskId, {
    status: 'completed',
    completedAt: new Date()
  });

  // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–∫–æ–≤ (–µ—Å–ª–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ)
  if (task.type === 'refill') {
    await this.updateInventoryAfterRefill(task);
  }
}
```

### 2. –û—Å—Ç–∞—Ç–∫–∏

```typescript
// ‚úÖ –í–°–ï–ì–î–ê –ø—Ä–æ–≤–µ—Ä—è–π –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ç–æ–≤–∞—Ä–æ–≤ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –∑–∞–¥–∞—á–∏
async createRefillTask(dto: CreateRefillTaskDto) {
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤ –Ω–∞ —Å–∫–ª–∞–¥–µ
  for (const item of dto.items) {
    const inventory = await this.warehouseInventoryRepository.findOne({
      warehouseId: dto.warehouseId,
      nomenclatureId: item.nomenclatureId
    });

    if (!inventory || inventory.availableQuantity < item.plannedQuantity) {
      throw new BadRequestException(
        `–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Ç–æ–≤–∞—Ä–∞ –Ω–∞ —Å–∫–ª–∞–¥–µ: ${item.nomenclatureName}`
      );
    }
  }

  // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
  const task = await this.taskRepository.save(dto);

  // –†–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–æ–≤
  await this.reserveInventory(task);

  return task;
}
```

---

## üì∏ –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞:

```typescript
/**
 * –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –∫ –∑–∞–¥–∞—á–µ
 *
 * –ü–†–ê–í–ò–õ–ê:
 * - –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä: 5 –ú–ë
 * - –§–æ—Ä–º–∞—Ç—ã: JPG, PNG, WEBP
 * - –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã —Ç–µ–≥–∏ –¥–ª—è –ø–æ–∏—Å–∫–∞
 * - –°–æ—Ö—Ä–∞–Ω—è—Ç—å EXIF (GPS, –¥–∞—Ç–∞)
 */
async uploadTaskPhoto(
  file: Express.Multer.File,
  taskId: string,
  category: 'task_photo_before' | 'task_photo_after'
) {
  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞
  if (file.size > 5_000_000) {
    throw new BadRequestException('–§–∞–π–ª —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–π (–º–∞–∫—Å 5 –ú–ë)');
  }

  // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞
  const allowedMimes = ['image/jpeg', 'image/png', 'image/webp'];
  if (!allowedMimes.includes(file.mimetype)) {
    throw new BadRequestException('–ù–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞');
  }

  // –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ EXIF
  const exif = await this.extractExif(file);

  // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏
  const filename = `task-${taskId}-${Date.now()}-${randomUUID()}.${ext}`;

  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞
  const path = await this.storage.save(file, filename);

  // –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ –ë–î
  const savedFile = await this.fileRepository.save({
    filename,
    originalFilename: file.originalname,
    path,
    url: `/uploads/${filename}`,
    mimeType: file.mimetype,
    sizeBytes: file.size,
    categoryId: await this.getCategoryId(category),
    entityType: 'task',
    entityId: taskId,
    tags: this.generateTags(taskId, category), // ['–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ', 'MAC-001', '–¥–æ']
    geolocation: exif.gps,
    takenAt: exif.dateTime,
    uploadedBy: userId
  });

  return savedFile;
}
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–¥—É–ª—è:

```typescript
describe('TaskService', () => {
  describe('completeTask', () => {
    it('–¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–æ—Å–∏—Ç—å –æ—à–∏–±–∫—É –µ—Å–ª–∏ –Ω–µ—Ç —Ñ–æ—Ç–æ –î–û', async () => {
      // Arrange
      const taskId = 'test-task-id';
      mockFileRepository.find.mockResolvedValue([]); // –ù–µ—Ç —Ñ–æ—Ç–æ

      // Act & Assert
      await expect(
        service.completeTask(taskId)
      ).rejects.toThrow('–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Ñ–æ—Ç–æ –î–û –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è');
    });

    it('–¥–æ–ª–∂–µ–Ω –æ–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ—Å–ª–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è', async () => {
      // Arrange
      const task = createMockRefillTask();
      const photos = createMockPhotos(task.id);

      // Act
      await service.completeTask(task.id);

      // Assert
      expect(mockInventoryService.updateAfterRefill).toHaveBeenCalledWith(task);
    });

    it('–¥–æ–ª–∂–µ–Ω —Å–æ–∑–¥–∞—Ç—å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –ø–æ—Å–ª–µ –∏–Ω–∫–∞—Å—Å–∞—Ü–∏–∏', async () => {
      // Arrange
      const task = createMockCollectionTask();

      // Act
      await service.completeTask(task.id);

      // Assert
      expect(mockFinanceService.createOperation).toHaveBeenCalledWith({
        type: 'income',
        amount: task.actualAmount,
        taskId: task.id
      });
    });
  });
});
```

### Coverage —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
- **Unit tests**: –º–∏–Ω–∏–º—É–º 70% coverage
- **Integration tests**: –≤—Å–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ –ø–æ—Ç–æ–∫–∏
- **E2E tests**: –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

---

## üîÑ Git workflow

### Commit messages (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç):

```bash
# –§–æ—Ä–º–∞—Ç
<type>(<scope>): <subject>

<body>

<footer>

# –ü—Ä–∏–º–µ—Ä—ã
feat(tasks): add photo validation before task completion

Implemented mandatory photo check for refill and collection tasks.
Tasks cannot be completed without before/after photos.

Closes #123

fix(inventory): correct 3-level inventory update logic

Fixed bug where operator inventory wasn't updated after refill.
Now properly tracks: warehouse ‚Üí operator ‚Üí machine.

Refs #456

docs(architecture): update manual operations guide

Added detailed flow for component cleaning process.
```

### Types:
- **feat**: –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è
- **fix**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∞–≥–∞
- **docs**: –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- **style**: –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞
- **refactor**: –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥
- **test**: –¢–µ—Å—Ç—ã
- **chore**: –†—É—Ç–∏–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### Branch naming:
```bash
feature/task-photo-validation
fix/inventory-update-bug
docs/add-api-documentation
refactor/simplify-auth-logic
```

---

## üö® –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –∫–æ–º–º–∏—Ç–æ–º

### Pre-commit checklist:

```bash
# 1. –õ–∏–Ω—Ç–∏–Ω–≥
npm run lint

# 2. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
npm run format

# 3. –¢–∏–ø—ã (TypeScript)
npm run type-check

# 4. –¢–µ—Å—Ç—ã
npm run test

# 5. Build
npm run build
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ö—É–∫–∏ (–∏—Å–ø–æ–ª—å–∑—É–π husky):

```json
{
  "husky": {
    "hooks": {
      "pre-commit": "lint-staged",
      "commit-msg": "commitlint -E HUSKY_GIT_PARAMS"
    }
  },
  "lint-staged": {
    "*.{ts,tsx}": [
      "eslint --fix",
      "prettier --write"
    ],
    "*.{json,md}": [
      "prettier --write"
    ]
  }
}
```

---

## üìù –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∫–æ–¥–∞

### JSDoc –¥–ª—è –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤:

```typescript
/**
 * –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø—Ä–æ–¥–∞–∂–∏ –∏–∑ Excel/CSV —Ñ–∞–π–ª–∞
 *
 * –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞: 20 –∫–æ–ª–æ–Ω–æ–∫ (–¥–∞—Ç–∞, –∞–ø–ø–∞—Ä–∞—Ç, —Ç–æ–≤–∞—Ä, —Ü–µ–Ω–∞, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ, ...)
 *
 * –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
 * - –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç –∞–ø–ø–∞—Ä–∞—Ç—ã –ø–æ –∫–æ–¥—É
 * - –°–æ–ø–æ—Å—Ç–∞–≤–ª—è–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
 * - –°–æ–∑–¥–∞—ë—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
 * - –û–±–Ω–æ–≤–ª—è–µ—Ç –æ—Å—Ç–∞—Ç–∫–∏
 *
 * @param file - –ó–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–π —Ñ–∞–π–ª (Excel –∏–ª–∏ CSV)
 * @param userId - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –≤—ã–ø–æ–ª–Ω—è—é—â–µ–≥–æ –∏–º–ø–æ—Ä—Ç
 * @returns –†–µ–∑—É–ª—å—Ç–∞—Ç –∏–º–ø–æ—Ä—Ç–∞ (–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫, –æ—à–∏–±–∫–∏)
 *
 * @throws BadRequestException –µ—Å–ª–∏ —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞ –Ω–µ–≤–µ—Ä–Ω—ã–π
 * @throws NotFoundException –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã –∞–ø–ø–∞—Ä–∞—Ç—ã/—Ç–æ–≤–∞—Ä—ã
 *
 * @example
 * const result = await salesService.importFromFile(file, userId);
 * console.log(`–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ ${result.successfulRows} —Å—Ç—Ä–æ–∫`);
 *
 * @see docs/guides/sales-import-guide.md
 */
async importSalesFromFile(
  file: Express.Multer.File,
  userId: string
): Promise<ImportResult> {
  // –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
}
```

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –§–∞–∑–∞ 1: MVP (–ù–µ–¥–µ–ª–∏ 1-4)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ö–†–ò–¢–ò–ß–ù–´–ô**

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
1. ‚úÖ –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
2. ‚úÖ –ê–ø–ø–∞—Ä–∞—Ç—ã –∏ –ª–æ–∫–∞—Ü–∏–∏ (CRUD)
3. ‚úÖ –ù–æ–º–µ–Ω–∫–ª–∞—Ç—É—Ä–∞ (—Ç–æ–≤–∞—Ä—ã, –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã, —Ä–µ—Ü–µ–ø—Ç—ã)
4. ‚úÖ –ó–∞–¥–∞—á–∏ —Å —Ñ–æ—Ç–æ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
5. ‚úÖ Telegram –±–æ—Ç (–±–∞–∑–æ–≤—ã–π)
6. ‚úÖ Audit logs

**–ö—Ä–∏—Ç–µ—Ä–∏–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏:**
- –û–ø–µ—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ —á–µ—Ä–µ–∑ Telegram —Å —Ñ–æ—Ç–æ
- –ê–¥–º–∏–Ω –≤–∏–¥–∏—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É —Å —Ñ–æ—Ç–æ –≤ web-–ø–∞–Ω–µ–ª–∏
- –û—Å—Ç–∞—Ç–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### –§–∞–∑–∞ 2: Important (–ù–µ–¥–µ–ª–∏ 5-8)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –í–´–°–û–ö–ò–ô**

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
1. ‚úÖ –ò–º–ø–æ—Ä—Ç –ø—Ä–æ–¥–∞–∂
2. ‚úÖ 3-—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Å—Ç–∞—Ç–∫–æ–≤
3. ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–æ–π–∫–æ–π
4. ‚úÖ –ò–Ω—Ü–∏–¥–µ–Ω—Ç—ã
5. ‚úÖ –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–µ –∂–∞–ª–æ–±—ã

### –§–∞–∑–∞ 3: Advanced (–ù–µ–¥–µ–ª–∏ 9-16)
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –°–†–ï–î–ù–ò–ô**

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:
1. ‚úÖ –°–∫–ª–∞–¥ –∏ –ø–∞—Ä—Ç–∏–∏
2. ‚úÖ –†–µ–π—Ç–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
3. ‚úÖ –í—Å–µ –æ—Ç—á—ë—Ç—ã
4. ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

---

## ‚ö†Ô∏è –û–±—â–∏–µ –æ—à–∏–±–∫–∏ –∏ –∫–∞–∫ –∏—Ö –∏–∑–±–µ–∂–∞—Ç—å

### ‚ùå –û—à–∏–±–∫–∞ 1: –ó–∞–±—ã—Ç—å –ø—Ä–æ –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ç–æ
```typescript
// –ü–õ–û–•–û
async completeTask(taskId: string) {
  await this.taskRepo.update(taskId, { status: 'completed' });
}

// –•–û–†–û–®–û
async completeTask(taskId: string) {
  await this.validatePhotos(taskId); // –í—ã–±—Ä–æ—Å–∏—Ç –æ—à–∏–±–∫—É –µ—Å–ª–∏ –Ω–µ—Ç —Ñ–æ—Ç–æ
  await this.taskRepo.update(taskId, { status: 'completed' });
}
```

### ‚ùå –û—à–∏–±–∫–∞ 2: –ù–µ –æ–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏ –ø–æ—Å–ª–µ –∑–∞–¥–∞—á–∏
```typescript
// –ü–õ–û–•–û
async completeRefillTask(task: Task) {
  await this.taskRepo.update(task.id, { status: 'completed' });
  // –ó–∞–±—ã–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –æ—Å—Ç–∞—Ç–∫–∏!
}

// –•–û–†–û–®–û
async completeRefillTask(task: Task) {
  await this.taskRepo.update(task.id, { status: 'completed' });
  await this.inventoryService.updateAfterRefill(task); // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!
}
```

### ‚ùå –û—à–∏–±–∫–∞ 3: –°–æ–∑–¥–∞—Ç—å API –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∞–ø–ø–∞—Ä–∞—Ç–∞–º
```typescript
// –ü–õ–û–•–û - –≤ –ø—Ä–æ–µ–∫—Ç–µ –ù–ï–¢ –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è!
async getMachineOnlineStatus(machineId: string) {
  return await this.machineAPI.getStatus(machineId); // –¢–∞–∫–æ–≥–æ API –Ω–µ—Ç!
}

// –•–û–†–û–®–û - —Å—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –∑–∞–¥–∞—á–∏
async updateMachineStatus(machineId: string, status: string) {
  return await this.machineRepo.update(machineId, { status });
}
```

### ‚ùå –û—à–∏–±–∫–∞ 4: –°–ª–æ–∂–Ω–∞—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –≥–¥–µ –º–æ–∂–Ω–æ –ø—Ä–æ—â–µ
```typescript
// –ü–õ–û–•–û - –∏–∑–ª–∏—à–Ω—è—è –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è
abstract class BaseInventoryStrategy {
  abstract updateInventory(): Promise<void>;
}
class WarehouseInventoryStrategy extends BaseInventoryStrategy { ... }
class UserInventoryStrategy extends BaseInventoryStrategy { ... }

// –•–û–†–û–®–û - –ø—Ä–æ—Å—Ç–æ –∏ –ø–æ–Ω—è—Ç–Ω–æ
async updateWarehouseInventory(data) { ... }
async updateUserInventory(data) { ... }
async updateMachineInventory(data) { ... }
```

---

## üìö –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ —á—Ç–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º

1. **README.md** - –æ–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
2. **docs/architecture/manual-operations.md** - –ö–†–ò–¢–ò–ß–ù–û! –ö–æ–Ω—Ü–µ–ø—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã
3. **docs/architecture/database-schema.md** - —Å—Ö–µ–º–∞ –ë–î
4. **docs/architecture/roadmap.md** - –ø–ª–∞–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
5. **docs/dictionaries/system-dictionaries.md** - –≤—Å–µ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∏

---

## üéì –î–ª—è –Ω–æ–≤—ã—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –®–∞–≥ 1: –ò–∑—É—á–∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É (2 —á–∞—Å–∞)
- –ü—Ä–æ—á–∏—Ç–∞–π manual-operations.md –ø–æ–ª–Ω–æ—Å—Ç—å—é
- –ü–æ–π–º–∏ –ø–æ—á–µ–º—É –ù–ï–¢ –ø—Ä—è–º–æ–≥–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –∞–ø–ø–∞—Ä–∞—Ç–∞–º
- –ò–∑—É—á–∏ –æ—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ (–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ, –∏–Ω–∫–∞—Å—Å–∞—Ü–∏—è, –º–æ–π–∫–∞)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏–µ (1 —á–∞—Å)
```bash
# Clone repo
git clone https://github.com/jamsmac/VendHub.git
cd VendHub

# Setup backend
cd backend
cp .env.example .env
npm install
docker-compose up -d postgres redis
npm run migration:run
npm run seed:dictionaries

# Setup frontend
cd ../frontend
cp .env.example .env
npm install
npm run dev
```

### –®–∞–≥ 3: –ù–∞—á–Ω–∏ —Å –º–∞–ª–æ–≥–æ (–ø–µ—Ä–≤–∞—è –∑–∞–¥–∞—á–∞)
- –°–æ–∑–¥–∞–π CRUD –¥–ª—è –ø—Ä–æ—Å—Ç–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ª–æ–∫–∞—Ü–∏–∏)
- –î–æ–±–∞–≤—å —Ç–µ—Å—Ç—ã
- –°–æ–∑–¥–∞–π PR –¥–ª—è review
- –ü–æ–ª—É—á–∏ —Ñ–∏–¥–±–µ–∫

---

## üî• –ó–æ–ª–æ—Ç—ã–µ –ø—Ä–∞–≤–∏–ª–∞

1. **–§–æ—Ç–æ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã** - –Ω–µ–ª—å–∑—è –∑–∞–∫—Ä—ã—Ç—å –∑–∞–¥–∞—á—É –±–µ–∑ —Ñ–æ—Ç–æ –î–û/–ü–û–°–õ–ï
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤–µ–∑–¥–µ** - –ø—Ä–æ–≤–µ—Ä—è–π –≤—Å–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
3. **–¢–µ—Å—Ç—ã –ø–∏—à–∏ —Å—Ä–∞–∑—É** - –Ω–µ –æ—Ç–∫–ª–∞–¥—ã–≤–∞–π –Ω–∞ –ø–æ—Ç–æ–º
4. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π –ø—É–±–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã** - JSDoc –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω
5. **–°–ª–µ–¥—É–π roadmap** - –Ω–µ –¥–µ–ª–∞–π —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —Ñ–∞–∑—ã 3 –≤ —Ñ–∞–∑–µ 1
6. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ > –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è** - –Ω–µ —É—Å–ª–æ–∂–Ω—è–π –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
7. **Git commits —á–∏—Ç–∞–µ–º—ã–µ** - –∏—Å–ø–æ–ª—å–∑—É–π conventional commits
8. **Code review –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** - –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–µ—Ä–∂–∏ –±–µ–∑ review

---

## üìû –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å

–ï—Å–ª–∏ –Ω–µ —É–≤–µ—Ä–µ–Ω –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–º —Ä–µ—à–µ–Ω–∏–∏:
1. –ü—Ä–æ–≤–µ—Ä—å docs/architecture/manual-operations.md
2. –°–ø—Ä–æ—Å–∏ –≤ –∫–æ–º–∞–Ω–¥–µ
3. –°–æ–∑–¥–∞–π issue —Å –≤–æ–ø—Ä–æ—Å–æ–º
4. –ù–µ –ø—Ä–∏–¥—É–º—ã–≤–∞–π —Å–∞–º - –º–æ–∂–µ—à—å –ø–æ–π—Ç–∏ –Ω–µ –≤ —Ç—É —Å—Ç–æ—Ä–æ–Ω—É

---

**–£—Å–ø–µ—à–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏! üöÄ**

_–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-11-14_
